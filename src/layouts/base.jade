//- Mixin for post, used on homepage and post page
mixin postHead(post)
  .post-head.group
    a(href="#{data.baseUrl}#{post.url}")
      h1.post-title= post.title
    span.post-date!= [post.date.getUTCFullYear(), post.date.getUTCMonth() + 1, post.date.getUTCDate()].join(' &#183; ')

mixin postHeadList(post)
  .post-head.group
    a(href="#{data.baseUrl}#{post.url}")
      h1.post-title.list= post.title
    span.list.post-date!= [post.date.getUTCFullYear(), post.date.getUTCMonth() + 1, post.date.getUTCDate()].join(' &#183; ')

mixin post(post)
  mixin postHead(post)
  //- mixin share(post)
  .post-body.markdown!= post.content

mixin share(post)
  .share-icons.share-icons-mini
    a(href="https://www.facebook.com/sharer/sharer.php?u=http://mindthecode.com/#{post.url}",class="social-media-facebook social-media-button js-social-popup first")
      span(class="icon-facebook")
      span(class="fb-share-count count-box")
    a(href="https://twitter.com/intent/tweet?text=#{post.title} http://mindthecode.com/#{post.url} via @stefvdham",class="social-media-twitter social-media-button js-social-popup")
      span(class="icon-twitter")
      span(class="tweet-count count-box")
    .is-clear
      &nbsp

doctype 5
html
  head
    meta(charset="utf-8")
    meta(name="viewport", content="width=device-width, initial-scale=1, user-scalable=no")
    meta(http-equiv="cleartype",content="on")
    link(rel="icon", type="image/png", href="#{data.baseUrl}favicon.ico")
    link(href="#{data.baseUrl}styles/main.css", rel="stylesheet")
    link(href="http://mindthecode.com/feed.xml",type="application/atom+xml",rel="alternate",title="Mindthecode Feed")
    link(rel="author",href="https://plus.google.com/102230925443628784177?rel=author")
    meta(property="fb:admins",content="1322812414")
    meta(property="og:type",content="article")
    meta(property="og:image",content="http://mindthecode.com/images/og_image.png")
    meta(property="og:site_name",content="Mindthecode")
    meta(property="fb:app_id",content="116332715192025")
    meta(name="twitter:creator",content="@stefvdham")
    meta(name="twitter:card",content="summary")
    meta(name="twitter:image:" content="http://mindthecode.com/images/og_image.png")
    block head
      title= "Mindthecode"
      link(rel="canonical",href="http://mindthecode.com/")
      meta(name="description", content="Rambling about all things web.")
      meta(property="og:title",content="Mindthecode")
      meta(property="og:description",content="Rambling about all things web.")
      meta(property="og:url",content="http://mindthecode.com/")
      meta(name="twitter:title",content="Mindthecode")
      meta(name="twitter:description",content="Rambling about all things web.")// Twitter
    script(type="text/javascript").
      !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
  body
    nav
      .logo
        a(href="#{data.baseUrl}")
          //- img(src='/images/logo.png',id="logo",data-at2x="/images/logo@2x.png")
          img(src='/images/semicolon.png',id='semicolon')
          br
          img(src='/images/logo_white.png')
      #tagline
        p by Stef van den Ham
      hr
      //- .avatar
        a(href="#{data.baseUrl}")
          img(src='/images/avatar.png')
          br
          br
          a(href="https://twitter.com/stefvdham",class="twitter-follow-button",data-show-count="false",data-size="small",data-show-screen-name="false") Follow @stefvdham
        p Stef van den Ham<br />Full stack web developer.<br /> Solving the web one pixel at a time.
      ul.nav-links
        li.text-link
          a(href="#{data.baseUrl}archives.html") blog
        li.text-link
          a(href="#{data.baseUrl}about.html") about
        //- li.text-link
          //- a(href="#{data.baseUrl}projects.html") projects
      .social-media
        a.icon-github(href="https://github.com/hyra")
        a.icon-twitter(href="https://twitter.com/stefvdham")
    .container
      .content
        block content
    script(src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js", type="text/javascript")
    script(src="#{data.baseUrl}scripts/main.js", type="text/javascript")
    //- script(src="#{data.baseUrl}scripts/retina-1.1.0.min.js", type="text/javascript")
    script.
      if(window.devicePixelRatio) { $("#logo").attr('src', '/images/logo@2x.png'); }
      var _gaq = _gaq || [];
      var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
      _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
      _gaq.push(['_setAccount', 'UA-20048990-9']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

      $(document).ready(function() {
        $.get('http://graph.facebook.com/?id='+document.URL, function(d) {
          var facebookCount = d.shares;
          $('.fb-share-count.count-box').html(facebookCount);
        });
        $.getJSON('http://urls.api.twitter.com/1/urls/count.json?url=' + document.URL + '&callback=?', function(d) {
          var twitterCount = d.count;
          $('.tweet-count.count-box').html(twitterCount);
        });
      });
